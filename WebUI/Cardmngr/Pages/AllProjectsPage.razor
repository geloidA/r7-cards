@page "/all-projects"
@attribute [Authorize]

@using Cardmngr.Components.ProjectAggregate.Dashboard

<PageTitle>Проекты</PageTitle>

@if (SummaryService.GanttModeEnabled)
{    
    <div class="h-full pt-1 pb-2 pl-1 pr-1">
        @if (allProjects.Count == 0)
        {
            <Loading Width="50" />
        }
        else
        {
            <ProjectGantt @ref="projectGantt" 
                Statuses="_cache.Statuses" 
                GetItems="GetGanttChartItems"
                HighlightRoot />
        }
    </div>
}
else
{
    <div class="flex flex-col p-1" style="overflow-y: auto; overflow-x: hidden;">
        <CascadingValue Value="userId" Name="UserId" IsFixed >
            <div class="flex flex-col h-full overflow-x-hidden overflow-y-auto gap-2" >
                @if (allProjects.Count != 0)
                {
                    foreach (var project in allProjects)
                    {                    
                        <StaticProjectState @key="project" ViewModel="project" />
                    }
                }
                else
                {
                    <Loading Width="50" />
                }
            </div>
        </CascadingValue>
    </div>
}
@* <div class="absolute bottom-0" style="right: 0; margin-bottom: 60px !important; margin-right: 5px;">
    <DashboardWatchManager Projects="allProjects.Select(x => x.ProjectInfo)" />
</div> *@
