<!DOCTYPE html>
<html lang="ru" style="overflow-y: hidden;">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Р7 Карточки</title>
        <base href="/" />
        <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />
        <link href="_content/Microsoft.FluentUI.AspNetCore.Components/css/reboot.css" rel="stylesheet" />
        <link href="css/site.css?version=1.1.5" rel="stylesheet" />
        <link rel="icon" type="image/png" href="favicon.png" />
        <link href="Cardmngr.styles.css" rel="stylesheet" />
        <link href="manifest.webmanifest" rel="manifest" />
        <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png" />
        <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png" />
    </head>

    <body >
        <div id="app" class="h-100">
            <div style="position:absolute; top:30vh; width:100%; text-align:center">
                <div style="display:flex; gap:10px; justify-content:center; align-items:center">
                <div class="spinner-border" style="width: 2.5rem; height: 2.5rem;" role="status"></div>
                Приложение загружается...
                </div>
            </div>
        </div>

        <div id="blazor-error-ui">
            Произошла непредвиденная ошибка.
            <a href="" class="reload">Перезагрузить</a>
            <a class="dismiss">🗙</a>
        </div>
        
        <script src="_framework/blazor.webassembly.js" ></script>
        <script src="js/app.js"></script>
        <script src="_content/Microsoft.FluentUI.AspNetCore.Components/Microsoft.FluentUI.AspNetCore.Components.lib.module.js" type="module" async></script>
        <script src="_content/Microsoft.FluentUI.AspNetCore.Components/js/loading-theme.js" type="text/javascript"></script>
        <loading-theme storage-name="theme"></loading-theme>
        <script>
            navigator.serviceWorker.register('service-worker.js');
            async function updateVersion(newVersion) {
                var key = 'r7cards-version';
                var oldVersion = localStorage.getItem(key);
                if (oldVersion == null) {
                    localStorage.setItem(key, newVersion);
                }
                else if (newVersion != oldVersion) {
                    localStorage.setItem(key, newVersion);
                    const cacheKeys = await caches.keys();
                    await Promise.all(cacheKeys.map(key => caches.delete(key)));
                    navigator.serviceWorker.register('/service-worker.js', { updateViaCache: 'none' }).then(function (registration) {
                        window.location.reload(); 
                    }).catch(function (error) {
                        console.log(`Registration failed with ${error}`);
                    });
                }
            }        
        </script>
    </body>
</html>
