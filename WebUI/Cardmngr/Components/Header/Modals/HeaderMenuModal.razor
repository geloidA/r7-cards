@inject NavigationManager NavigationManager
@inject ILocalStorageService LocalStorage
@inject AuthenticationStateProvider AuthenticationState

<Cardmngr.Components.Modals.MyBlazored.Offcanvas ShowCloseBtn="false"
    Class="my-offcanvas my-offcanvas-left" Style="max-width: 300px;">
    <OffcanvasHeader>
        <a class="text-dark fw-bold fs-4 ms-3" href="/">
            <Icon Name="IconName.Stack" />
            Карточки
        </a>
    </OffcanvasHeader>
    <OffcanvasBody Class="d-flex flex-column">
        <Card class="bg-shadow">
            <div class="align-self-center">🫧 Пусто 🫧</div>
        </Card>
        <div class="container h-100">
            <footer class="footer d-flex gradient-bg-vertical" >
                <div class="mx-4 my-4">
                    <Tool IconName="IconName.Send" TooltipTitle="Отправить обратную связь" OnClick=@(() => NavigationManager.NavigateTo("feedback-board")) />
                    <div class="mt-3" @onmouseenter="() => logoutHover = true" @onmouseout="() => logoutHover = false">
                        <Tool IconName="@(logoutHover ? IconName.DoorOpenFill : IconName.DoorClosedFill)" 
                            TooltipTitle="Выйти" IconColor="IconColor.Dark" IconSize="IconSize.x5"
                            OnClick="LogoutAsync" />
                    </div>
                </div>
            </footer>
        </div>
    </OffcanvasBody>
</Cardmngr.Components.Modals.MyBlazored.Offcanvas>

@code {
    [Parameter] public IEnumerable<Project>? UserProjects { get; set; }

    private bool logoutHover;

    private async Task LogoutAsync()
    {
        if (AuthenticationState is { })
        {            
            AuthenticationState.ToCookieProvider().ClearAuthInfo();
            await LocalStorage.RemoveItemAsync("isauthenticated");
            NavigationManager.NavigateTo("login");
        }
    }
}
